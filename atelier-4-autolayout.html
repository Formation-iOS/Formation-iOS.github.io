
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Atelier 4 - Auto Layout · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="atelier-5-networking.html" />
    
    
    <link rel="prev" href="atelier-3-navigation.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="atelier-1-xcode-et-interface-builder.html">
            
                <a href="atelier-1-xcode-et-interface-builder.html">
            
                    
                    Atelier 1 - Xcode et Interface Builder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="atelier-2-parsing-de-donnees.html">
            
                <a href="atelier-2-parsing-de-donnees.html">
            
                    
                    Atelier 2 - Parsing de données
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="atelier-3-navigation.html">
            
                <a href="atelier-3-navigation.html">
            
                    
                    Atelier 3 - Navigation
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5" data-path="atelier-4-autolayout.html">
            
                <a href="atelier-4-autolayout.html">
            
                    
                    Atelier 4 - Auto Layout
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="atelier-5-networking.html">
            
                <a href="atelier-5-networking.html">
            
                    
                    Atelier 5 - Networking avec Alamofire
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="atelier-6-login.html">
            
                <a href="atelier-6-login.html">
            
                    
                    Atelier 6 - Connexion et compte utilisateur
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="atelier-7-debug.html">
            
                <a href="atelier-7-debug.html">
            
                    
                    Atelier 7 - Debug et amélioration du code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="atelier-8-MapView.html">
            
                <a href="atelier-8-MapView.html">
            
                    
                    Atelier 8 - Affichage de données sur une carte
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="atelier-9-GeolocalistionEtNotifications.html">
            
                <a href="atelier-9-GeolocalistionEtNotifications.html">
            
                    
                    Atelier 9 - Géolocalisation et notifications
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Atelier 4 - Auto Layout</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="auto-layout">Auto Layout</h1>
<h2 id="introduction">Introduction</h2>
<p>Apple a introduit le syst&#xE8;me Auto Layout de mise en page de l&apos;interface graphique en 2012, pour la sortie de l&apos;iPhone 5.<br>Avant, il n&apos;y avait qu&apos;une seule taille d&apos;&#xE9;cran sur les iPhones, et le syst&#xE8;me de mise en page de l&apos;&#xE9;poque, tr&#xE8;s simple, suffisait largement.</p>
<p>Aujourd&apos;hui, Apple recommande de supporter iOS 10 et 11. Pour supporter tous les iPhones compatibles, on doit g&#xE9;rer 4 tailles diff&#xE9;rentes d&apos;&#xE9;cran. Pour g&#xE9;rer les iPads, on rajoute encore 3 autres tailles. A cela vient s&apos;ajouter la gestion de l&apos;affichage en orientation paysage (&#xAB; landscape &#xBB;), en plus de l&apos;orientation portrait.</p>
<p>Auto Layout est l&apos;outil indispensable pour r&#xE9;pondre &#xE0; ces probl&#xE9;matiques. Il permet &#xE0; l&apos;interface graphique d&apos;une application de s&apos;adapter aux diff&#xE9;rents devices et orientations. Auto Layout r&#xE9;duit, agrandit, ou d&#xE9;place les diff&#xE9;rents &#xE9;l&#xE9;ments de l&apos;interface graphique, en fonction du device.</p>
<p>Enfin, Auto Layout aide &#xE0; g&#xE9;rer l&apos;internationalisation d&apos;une app. En effet, il permet &#xE0; la mise en page de s&apos;adapter en fonction de la longueur du texte. Cela se r&#xE9;v&#xE8;le bien utile quand on traduit une application, de l&apos;anglais &#xE0; l&apos;allemand par exemple, car les mots allemands sont en g&#xE9;n&#xE9;ral bien plus longs.</p>
<p>Voici le lien vers la documentation d&apos;Apple sur Auto Layout : <a href="https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/AutolayoutPG/index.html" target="_blank">https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/AutolayoutPG/index.html</a></p>
<p><strong>Notions n&#xE9;cessaires :</strong> Contraintes de layout, notion de &#xAB; intrinsic content size &#xBB;, hugging et resistance, Safe Area</p>
<h2 id="auto-layout-par-la-pratique">Auto Layout par la pratique</h2>
<p>Toutes les corrections des TPs sur Auto Layout sont disponibles sur GitHub.</p>
<p>Dans Xcode, s&#xE9;lectionnez File-&gt;New-&gt;Project..., puis cr&#xE9;ez un projet &#xAB; Single View App&#xBB;, et donnez lui le nom &#xAB; AutoLayout &#xBB; par exemple.</p>
<h3 id="interface-builder-loutil-de-cr&#xE9;ation-des-interfaces-graphiques-dans-xcode">Interface builder, l&apos;outil de cr&#xE9;ation des interfaces graphiques dans Xcode</h3>
<p>Voici &#xE0; quoi ressemble la partie Interface Builder de Xcode, dans un projet qui contient d&#xE9;j&#xE0; un bouton.</p>
<p><img src="assets/interface-builder.png" alt=""></p>
<h3 id="activation-de-auto-layout">Activation de Auto Layout</h3>
<p>Tout d&apos;abord, assurez-vous que votre fichier Main.storyboard utilise &#xAB; Auto Layout &#xBB;. Cela devrait d&#xE9;j&#xE0; &#xEA;tre le cas.</p>
<p><img src="assets/xcode-ib-use-auto-layout.png" alt=""></p>
<h3 id="menus-pour-ajouter-des-contraintes-dauto-layout">Menus pour ajouter des contraintes d&apos;Auto Layout</h3>
<p>Explorez Interface Builder, ses diff&#xE9;rents menu et onglets. En bas &#xE0; droite de la partie centrale d&apos;Interface Builder, on trouve les menus d&apos;ajout de contraintes.</p>
<p><img src="assets/add-missing-constraints.png" alt=""></p>
<p><img src="assets/pin-constraints.png" alt=""></p>
<p><img src="assets/align.png" alt=""></p>
<h3 id="hugging-et-resistance">Hugging et Resistance</h3>
<p><img src="assets/hugging-resistance.png" alt=""></p>
<h3 id="affichage-sur-diff&#xE9;rents-devices-et-orientations">Affichage sur diff&#xE9;rents devices et orientations</h3>
<p>En bas de la partie centrale d&apos;Interface Builder, on trouve les diff&#xE9;rents devices et orientations. Ceci permet de pr&#xE9;visualiser le rendu de l&apos;interface graphique, avant m&#xEA;me de lancer l&apos;applictaion dans le simulateur.</p>
<p><img src="assets/ib-devices-orientation.png" alt=""></p>
<h3 id="menu-editor-de-xcode">Menu Editor de Xcode</h3>
<p>Dans le menu Editor de Xcode, on retrouve &#xE9;galement des actions d&#xE9;j&#xE0; accessibles &#xE0; d&apos;autres endroits dans Interface Builder.</p>
<p><img src="assets/editor-menu.png" alt=""></p>
<h4 id="erreur-dans-les-contraintes-dauto-layout">Erreur dans les contraintes d&apos;Auto Layout</h4>
<p>S&apos;il y a une erreur dans les contraintes d&apos;Auto Layout, certaines lignes repr&#xE9;sentant les contraintes vont appara&#xEE;tre en rouge. Par ailleurs, une fl&#xE8;che dans un rond rouge va appara&#xEE;tre dans la partie &#xAB; explorateur &#xBB; des &#xE9;l&#xE9;ments de la vue. Cliquez sur cette fl&#xE8;che pour voir le d&#xE9;tail des erreurs.</p>
<p><img src="assets/ib-error.png" alt=""></p>
<h3 id="erreur-dans-la-console-en-lan&#xE7;ant-dans-le-simulateur">Erreur dans la console en lan&#xE7;ant dans le simulateur</h3>
<p>Il est &#xE9;galement possible d&apos;avoir des erreurs qui apparaissent dans la console d&apos;Xcode &#xE0; l&apos;ex&#xE9;cution de l&apos;application.
Le message &quot;Unable to simultaneously satisfy constraints.&quot; veut dire que Auto Layout n&apos;a pas pu trouver une solution de mise en page pour satisfaire toutes les contraintes.
Il sugg&#xE8;re &#xE9;galement des solutions pour r&#xE9;soudre le probl&#xE8;me.</p>
<pre><code>2017-10-13 09:22:28.125847+0200 Films[97857:2972007] [LayoutConstraints] Unable to simultaneously satisfy constraints.
    Probably at least one of the constraints in the following list is one you don&apos;t want. 
    Try this: 
        (1) look at each constraint and try to figure out which you don&apos;t expect; 
        (2) find the code that added the unwanted constraint or constraints and fix it. 
(
    &quot;&lt;NSLayoutConstraint:0x6000000995f0 UIImageView:0x7ffb9bd1b240.height == 150   (active)&gt;&quot;,
    &quot;&lt;NSLayoutConstraint:0x60400009e140 V:[UIImageView:0x7ffb9bd1b240]-(0)-|   (active, names: &apos;|&apos;:UITableViewCellContentView:0x7ffb9bd1ab20 )&gt;&quot;,
    &quot;&lt;NSLayoutConstraint:0x60400009e190 V:|-(0)-[UIImageView:0x7ffb9bd1b240]   (active, names: &apos;|&apos;:UITableViewCellContentView:0x7ffb9bd1ab20 )&gt;&quot;,
    &quot;&lt;NSLayoutConstraint:0x60400009f090 &apos;UIView-Encapsulated-Layout-Height&apos; UITableViewCellContentView:0x7ffb9bd1ab20.height == 150   (active)&gt;&quot;
)
</code></pre><h3 id="exercice-1--les-2-boutons">Exercice 1 : les 2 boutons</h3>
<p>Essayez de re-cr&#xE9;er par vous m&#xEA;me l&apos;exercice de la demo live avec les 2 boutons de m&#xEA;me taille qui restent toujours en bas de l&apos;&#xE9;cran, quelques soient le device et l&apos;orientation.</p>
<p>Pour valider que tout fonctionne comme voulu, s&#xE9;lectionnez les diff&#xE9;rentes vues de devices dans Interface Builder (les iPhones et iPads), et les orientations portrait et paysage. &#xC9;galement, lancez l&apos;app dans diff&#xE9;rents simulateurs.</p>
<p><img src="assets/autolayout-2buttons-portrait.png" alt=""></p>
<p><img src="assets/autolayout-2buttons-landscape.png" alt=""></p>
<h3 id="exercice-2--la-galerie">Exercice 2 : la galerie</h3>
<p>Essayez de re-cr&#xE9;er par vous m&#xEA;me le 2&#xE8;me exercice de la demo live, qui affiche un &#xE9;cran d&#xE9;coup&#xE9; en 4 parties &#xE9;gales. Chaque partie est d&apos;une couleur donn&#xE9;e, et affiche une image et un texte.
Pensez bien &#xE0; tenir compte de la &#xAB; Safe Area &#xBB;.
Cet affichage doit fonctionner quelques soient le device et l&apos;orientation. Testez notamment dans le simulateur de l&apos;iPhone X.</p>
<p>Les 4 images sont disponibles dans ce fichier .zip : <a href="https://formation-ios.github.io/tutorialFiles/Animals.zip" target="_blank">Animals.zip</a></p>
<p><img src="assets/galerie-portrait.png" alt=""></p>
<p><img src="assets/galerie-landscape.png" alt=""></p>
<h3 id="exercice-3--auto-layout-dans-les-uitableview">Exercice 3 : Auto Layout dans les UITableView</h3>
<p>Dans cet exercice, vous allez devoir afficher une liste de films.</p>
<p>Reprenez le projet Xcode de l&apos;atelier 3, o&#xF9; vous aviez affich&#xE9; une liste de films et une vue de d&#xE9;tail, ou clonez ce repository qui contient la solution de l&apos;atelier 3 : <a href="https://github.com/Formation-iOS/Atelier3_Navigation" target="_blank">https://github.com/Formation-iOS/Atelier3_Navigation</a></p>
<p>Voici &#xE0; quoi doit ressembler l&apos;affichage de la liste des films. Notez que le titre des films peut prendre plusieurs lignes, par exercice &#xAB; Guardians of the Galaxy Vol. 2 &#xBB;. Dans ce cas le texte de la description prendra moins de place.</p>
<p><img src="assets/movies-tableview.png" alt=""></p>
<p>Quelques indices :</p>
<ul>
<li>utilisez un UINavigationController</li>
<li>utilisez un UITableViewController, avec des cellules de taille fixe</li>
<li>utilisez les notions de &#xAB; Content Hugging Priority &#xBB; et &#xAB; Content Compression Resistance Priority &#xBB;</li>
</ul>
<p>Note : votre classe qui h&#xE9;rite de UITableViewCell devrait &#xEA;tre d&#xE9;finie dans son propre fichier .swift.</p>
<h3 id="exercice-4--cellule-de-taille-dynamiques">Exercice 4 : cellule de taille dynamiques</h3>
<p>Certains synopsis de film sont trop longs et sont tronqu&#xE9;s. Nous allons adapter la taille de la cellule &#xE0; son contenu afin que l&apos;ensemble du synopsis soit visible.</p>
<p>La taille de la cellule va donc d&#xE9;pendre &#xE0; la fois de la taille du titre du film, mais aussi de sa description.</p>
<p>Pour cela, vous allez utiliser le calcul automatique de dimension de cellule d&apos;une UITableView : UITableViewAutomaticDimension.</p>
<pre><code class="lang-swift"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">viewDidLoad</span><span class="hljs-params">()</span></span> {
<span class="hljs-keyword">super</span>.viewDidLoad()

tableView.estimatedRowHeight = <span class="hljs-number">200</span>
tableView.rowHeight = <span class="hljs-type">UITableViewAutomaticDimension</span>
}
</code></pre>
<p>A vous de jouer, encore une fois, utilisez Auto Layout ! La cellule doit avoir une hauteur calculable sans ambiguit&#xE9; pour que le syt&#xE8;me marche correctement. Mettez donc bien les contraintes de haut en bas sans en oublier une.</p>
<h3 id="exercice-bonus--auto-layout-dans-les-uiscrollview">Exercice bonus : Auto Layout dans les UIScrollView</h3>
<p>Impl&#xE9;mentez une vue de d&#xE9;tail scrollable, en utilisant une UIScrollView, contenues dans un UIViewController basique.</p>
<p><strong><em>Astuce</em></strong> : comme la scrollview ne doit pas scroller en horizontal, ajoutez une contrainte pour lui dire que sa Width doit &#xEA;tre &#xE9;gale &#xE0; celle de sa vue parente</p>
<p><img src="assets/movie-detail.png" alt=""></p>
<h2 id="pour-aller-plus-loin">Pour aller plus loin</h2>
<p>Les points suivants ne sont pas abord&#xE9;s dans ce cours, car ils sont trop avanc&#xE9;s. N&#xE9;anmoins, il est bon de savoir qu&apos;ils existent, pour y avoir recours au cas o&#xF9; les m&#xE9;thodes moins avanc&#xE9;es sont trop limitantes.</p>
<h3 id="cr&#xE9;ation-des-contraintes-dauto-layout-dans-le-code">Cr&#xE9;ation des contraintes d&apos;Auto Layout dans le code</h3>
<p><a href="https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/AutolayoutPG/ProgrammaticallyCreatingConstraints.html#//apple_ref/doc/uid/TP40010853-CH16-SW1" target="_blank">Documentation d&apos;Apple : Programmatically Creating Constraints</a></p>
<h3 id="size-class">Size-class</h3>
<p><a href="https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/AutolayoutPG/Size-ClassSpecificLayout.html#//apple_ref/doc/uid/TP40010853-CH26-SW1" target="_blank">Documentation d&apos;Apple : Size-Class-Specific Layout</a></p>
<h3 id="mise-&#xE0;-jour-des-contraintes-dauto-layout-de-mani&#xE8;re-dynamique">Mise &#xE0; jour des contraintes d&apos;Auto Layout de mani&#xE8;re dynamique</h3>
<p><a href="https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/AutolayoutPG/ModifyingConstraints.html#//apple_ref/doc/uid/TP40010853-CH29-SW1" target="_blank">Documentation d&apos;Apple : Changing Constraints</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="atelier-3-navigation.html" class="navigation navigation-prev " aria-label="Previous page: Atelier 3 - Navigation">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="atelier-5-networking.html" class="navigation navigation-next " aria-label="Next page: Atelier 5 - Networking avec Alamofire">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Atelier 4 - Auto Layout","level":"1.5","depth":1,"next":{"title":"Atelier 5 - Networking avec Alamofire","level":"1.6","depth":1,"path":"atelier-5-networking.md","ref":"atelier-5-networking.md","articles":[]},"previous":{"title":"Atelier 3 - Navigation","level":"1.4","depth":1,"path":"atelier-3-navigation.md","ref":"atelier-3-navigation.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"atelier-4-autolayout.md","mtime":"2018-01-31T20:50:55.676Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-08-31T07:33:02.881Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

